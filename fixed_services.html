<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>服务市场 - 时间银行</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- 导航栏 -->
    <nav class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <h1 class="text-xl font-bold text-gray-800">时间银行</h1>
                    </div>
                    <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="fixed_services.html" class="border-indigo-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                            服务市场
                        </a>
                        <a href="enhanced_activities.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                            社区活动
                        </a>
                        <a href="enhanced_points_mall.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                            积分商城
                        </a>
                    </div>
                </div>
                <div class="hidden sm:ml-6 sm:flex sm:items-center">
                    <div class="ml-3 relative">
                        <div>
                            <span id="user-name" class="text-sm font-medium text-gray-700 mr-2"></span>
                            <span id="user-points" class="text-sm font-medium text-green-600 mr-4"></span>
                            <button id="logout-button" class="bg-white py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                退出登录
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主内容 -->
    <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <div class="px-4 py-6 sm:px-0">
            <div class="border-4 border-dashed border-gray-200 rounded-lg p-4 bg-white">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">服务市场</h2>
                
                <!-- 服务类别 -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">服务类别</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-blue-100 p-4 rounded-lg text-center cursor-pointer hover:bg-blue-200">
                            <div class="text-blue-800 font-medium">家政服务</div>
                        </div>
                        <div class="bg-green-100 p-4 rounded-lg text-center cursor-pointer hover:bg-green-200">
                            <div class="text-green-800 font-medium">医疗护理</div>
                        </div>
                        <div class="bg-yellow-100 p-4 rounded-lg text-center cursor-pointer hover:bg-yellow-200">
                            <div class="text-yellow-800 font-medium">教育辅导</div>
                        </div>
                        <div class="bg-purple-100 p-4 rounded-lg text-center cursor-pointer hover:bg-purple-200">
                            <div class="text-purple-800 font-medium">陪伴聊天</div>
                        </div>
                    </div>
                </div>
                
                <!-- 服务列表 -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">热门服务</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="services-container">
                        <!-- 服务卡片将通过JavaScript动态添加 -->
                    </div>
                </div>
                
                <!-- 申请服务 -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">申请服务</h3>
                    <form id="service-request-form" class="space-y-4">
                        <div>
                            <label for="service-type" class="block text-sm font-medium text-gray-700">服务类型</label>
                            <select id="service-type" name="service-type" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                                <option value="家政服务">家政服务</option>
                                <option value="医疗护理">医疗护理</option>
                                <option value="教育辅导">教育辅导</option>
                                <option value="陪伴聊天">陪伴聊天</option>
                            </select>
                        </div>
                        <div>
                            <label for="service-description" class="block text-sm font-medium text-gray-700">服务描述</label>
                            <textarea id="service-description" name="service-description" rows="3" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border border-gray-300 rounded-md" placeholder="请详细描述您需要的服务..."></textarea>
                        </div>
                        <div>
                            <label for="service-time" class="block text-sm font-medium text-gray-700">期望时间</label>
                            <input type="datetime-local" id="service-time" name="service-time" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="service-duration" class="block text-sm font-medium text-gray-700">预计时长（小时） </label>
                            <input type="number" id="service-duration" name="service-duration" min="0.5" step="0.5" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        </div>
                        <div>
                            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                提交申请
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- 我的申请 -->
                <div class="mt-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">我的申请</h3>
                    <div class="bg-white shadow overflow-hidden sm:rounded-md">
                        <ul class="divide-y divide-gray-200" id="my-requests-container">
                            <!-- 申请记录将通过JavaScript动态添加 -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // 检查登录状态
        document.addEventListener('DOMContentLoaded', function() {
            const userDataStr = localStorage.getItem('timebank_user');
            if (!userDataStr) {
                alert('请先登录');
                window.location.href = 'enhanced_login.html';
                return;
            }
            
            const userData = JSON.parse(userDataStr);
            if (!userData.loggedIn) {
                alert('请先登录');
                window.location.href = 'enhanced_login.html';
                return;
            }
            
            // 显示用户信息
            document.getElementById('user-name').textContent = userData.username;
            document.getElementById('user-points').textContent = `积分: ${userData.points || 0}`;
            
            // 加载示例服务
            loadSampleServices();
            
            // 加载用户的服务申请
            loadUserRequests(userData.id);
            
            // 退出登录
            document.getElementById('logout-button').addEventListener('click', function() {
                userData.loggedIn = false;
                localStorage.setItem('timebank_user', JSON.stringify(userData));
                window.location.href = 'enhanced_login.html';
            });
            
            // 处理服务申请表单提交
            document.getElementById('service-request-form').addEventListener('submit', function(e) {
                e.preventDefault();
                submitServiceRequest(userData.id);
            });
        });
        
        // 加载示例服务
        function loadSampleServices() {
            const sampleServices = [
                { id: 1, type: '家政服务', title: '家庭清洁', description: '提供全面的家庭清洁服务，包括打扫、擦拭和整理。', provider: '张阿姨', duration: 2, points: 20 },
                { id: 2, type: '医疗护理', title: '血压测量', description: '专业测量血压，并提供健康建议。', provider: '李医生', duration: 0.5, points: 5 },
                { id: 3, type: '教育辅导', title: '数学辅导', description: '小学到初中数学辅导，耐心教学。', provider: '王老师', duration: 1.5, points: 15 },
                { id: 4, type: '陪伴聊天', title: '陪伴散步', description: '陪伴老人散步聊天，分享生活趣事。', provider: '小刘', duration: 1, points: 10 },
                { id: 5, type: '家政服务', title: '做饭服务', description: '提供上门做饭服务，可根据需求调整菜单。', provider: '陈师傅', duration: 1.5, points: 15 },
                { id: 6, type: '医疗护理', title: '康复指导', description: '提供基础康复训练指导，适合行动不便的老人。', provider: '赵护士', duration: 1, points: 10 }
            ];
            
            const container = document.getElementById('services-container');
            container.innerHTML = '';
            
            sampleServices.forEach(service => {
                const card = document.createElement('div');
                card.className = 'bg-white overflow-hidden shadow rounded-lg';
                card.innerHTML = `
                    <div class="px-4 py-5 sm:p-6">
                        <h4 class="text-lg font-medium text-gray-900">${service.title}</h4>
                        <div class="mt-2 max-w-xl text-sm text-gray-500">
                            <p>${service.description}</p>
                        </div>
                        <div class="mt-3 text-sm">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-2">
                                ${service.type}
                            </span>
                            <span class="text-gray-500">提供者: ${service.provider}</span>
                        </div>
                        <div class="mt-2 flex justify-between items-center">
                            <span class="text-sm text-gray-500">时长: ${service.duration}小时</span>
                            <span class="text-sm font-medium text-green-600">积分: ${service.points}</span>
                        </div>
                        <div class="mt-4">
                            <button type="button" class="inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" onclick="applyForService(${service.id})">
                                申请服务
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // 申请服务
        function applyForService(serviceId) {
            alert(`已申请服务ID: ${serviceId}，请等待审核`);
            // 实际应用中，这里应该将申请保存到localStorage或发送到服务器
        }
        
        // 加载用户的服务申请
        function loadUserRequests(userId) {
            // 从localStorage获取服务申请
            let requests = JSON.parse(localStorage.getItem('timebank_service_requests') || '[]');
            // 筛选当前用户的申请
            requests = requests.filter(req => req.userId === userId);
            
            const container = document.getElementById('my-requests-container');
            
            if (requests.length === 0) {
                container.innerHTML = '<li class="px-4 py-4 sm:px-6">暂无申请记录</li>';
                return;
            }
            
            container.innerHTML = '';
            requests.forEach(request => {
                const statusClass = {
                    'pending': 'bg-yellow-100 text-yellow-800',
                    'approved': 'bg-green-100 text-green-800',
                    'rejected': 'bg-red-100 text-red-800'
                };
                
                const statusText = {
                    'pending': '待审核',
                    'approved': '已通过',
                    'rejected': '已拒绝'
                };
                
                const li = document.createElement('li');
                li.className = 'px-4 py-4 sm:px-6';
                li.innerHTML = `
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-indigo-600 truncate">${request.serviceType}</p>
                        <div class="ml-2 flex-shrink-0 flex">
                            <p class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass[request.status] || statusClass.pending}">
                                ${statusText[request.status] || statusText.pending}
                            </p>
                        </div>
                    </div>
                    <div class="mt-2 sm:flex sm:justify-between">
                        <div class="sm:flex">
                            <p class="flex items-center text-sm text-gray-500">
                                ${request.description}
                            </p>
                        </div>
                        <div class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0">
                            <p>
                                申请时间: ${new Date(request.requestTime).toLocaleString()}
                            </p>
                        </div>
                    </div>
                `;
                container.appendChild(li);
            });
        }
        
        // 提交服务申请
        function submitServiceRequest(userId) {
            const serviceType = document.getElementById('service-type').value;
            const description = document.getElementById('service-description').value;
            const serviceTime = document.getElementById('service-time').value;
            const duration = document.getElementById('service-duration').value;
            
            if (!description || !serviceTime || !duration) {
                alert('请填写完整信息');
                return;
            }
            
            // 创建新的服务申请
            const newRequest = {
                id: Date.now(),
                userId: userId,
                serviceType: serviceType,
                description: description,
                serviceTime: serviceTime,
                duration: parseFloat(duration),
                requestTime: new Date().toISOString(),
                status: 'pending'
            };
            
            // 保存到localStorage
            const requests = JSON.parse(localStorage.getItem('timebank_service_requests') || '[]');
            requests.push(newRequest);
            localStorage.setItem('timebank_service_requests', JSON.stringify(requests));
            
            alert('服务申请已提交，请等待审核');
            
            // 重置表单
            document.getElementById('service-request-form').reset();
            
            // 刷新申请列表
            loadUserRequests(userId);
        }
    </script>
</body>
</html>

              
(Content truncated due to size limit. Use line ranges to read in chunks)
