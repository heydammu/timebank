                navActivities.classList.add('border-transparent', 'text-gray-500');
                
                navPoints.classList.add('border-blue-500', 'text-gray-900');
                navPoints.classList.remove('border-transparent', 'text-gray-500');
            });
            
            // 控制面板快捷按钮
            document.getElementById('view-services-btn').addEventListener('click', function(e) {
                e.preventDefault();
                navServices.click();
            });
            
            document.getElementById('view-activities-btn').addEventListener('click', function(e) {
                e.preventDefault();
                navActivities.click();
            });
            
            document.getElementById('view-products-btn').addEventListener('click', function(e) {
                e.preventDefault();
                navPoints.click();
            });
            
            // 退出登录
            document.getElementById('logout-button').addEventListener('click', function() {
                localStorage.removeItem('timebank_user');
                window.location.href = 'enhanced_login.html';
            });
            
            // 服务审核功能
            const serviceApplications = document.querySelectorAll('#service-applications-table tr');
            serviceApplications.forEach(row => {
                const approveBtn = row.querySelector('button.text-green-600');
                const rejectBtn = row.querySelector('button.text-red-600');
                const statusCell = row.querySelector('td:nth-child(6) span');
                
                if (approveBtn) {
                    approveBtn.addEventListener('click', function() {
                        statusCell.textContent = '已通过';
                        statusCell.classList.remove('bg-yellow-100', 'text-yellow-800');
                        statusCell.classList.add('bg-green-100', 'text-green-800');
                        approveBtn.disabled = true;
                        rejectBtn.disabled = true;
                        approveBtn.classList.add('opacity-50');
                        rejectBtn.classList.add('opacity-50');
                        alert('已通过该服务申请');
                    });
                }
                
                if (rejectBtn) {
                    rejectBtn.addEventListener('click', function() {
                        statusCell.textContent = '已拒绝';
                        statusCell.classList.remove('bg-yellow-100', 'text-yellow-800');
                        statusCell.classList.add('bg-red-100', 'text-red-800');
                        approveBtn.disabled = true;
                        rejectBtn.disabled = true;
                        approveBtn.classList.add('opacity-50');
                        rejectBtn.classList.add('opacity-50');
                        alert('已拒绝该服务申请');
                    });
                }
            });
            
            // 活动审核功能
            const activities = document.querySelectorAll('#activities-table tr');
            activities.forEach(row => {
                const approveBtn = row.querySelector('button.text-green-600');
                const rejectBtn = row.querySelector('button.text-red-600');
                const statusCell = row.querySelector('td:nth-child(6) span');
                
                if (approveBtn) {
                    approveBtn.addEventListener('click', function() {
                        statusCell.textContent = '已通过';
                        statusCell.classList.remove('bg-yellow-100', 'text-yellow-800');
                        statusCell.classList.add('bg-green-100', 'text-green-800');
                        approveBtn.disabled = true;
                        rejectBtn.disabled = true;
                        approveBtn.classList.add('opacity-50');
                        rejectBtn.classList.add('opacity-50');
                        alert('已通过该活动');
                    });
                }
                
                if (rejectBtn) {
                    rejectBtn.addEventListener('click', function() {
                        statusCell.textContent = '已拒绝';
                        statusCell.classList.remove('bg-yellow-100', 'text-yellow-800');
                        statusCell.classList.add('bg-red-100', 'text-red-800');
                        approveBtn.disabled = true;
                        rejectBtn.disabled = true;
                        approveBtn.classList.add('opacity-50');
                        rejectBtn.classList.add('opacity-50');
                        alert('已拒绝该活动');
                    });
                }
            });
            
            // 商品管理功能
            const products = document.querySelectorAll('#products-table tr');
            products.forEach(row => {
                const editBtn = row.querySelector('button.text-blue-600');